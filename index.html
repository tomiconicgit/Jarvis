<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
<title>Iconic Editor — Hybrid Three.js</title>
<meta name="theme-color" content="#0a0a0a"/>

<!-- ES module shim must load before the import map -->
<script async src="https://unpkg.com/es-module-shims@1.9.0/dist/es-module-shims.js"></script>
<script type="importmap">
{
  "imports": {
    "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
    "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
    "troika-three-text": "https://unpkg.com/troika-three-text@0.49.1/dist/troika-three-text.esm.js"
  }
}
</script>

<style>
  :root{
    --bg:#0b0c0f; --panel:rgba(20,22,28,.98); --panel-border:rgba(255,255,255,.08);
    --text:#eaeef5; --muted:#9aa3b2; --accent:#4da3ff; --toolbar:#111317;
    --panel-w:380px; /* desktop width */
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font:14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif}
  .app{position:fixed;inset:0;display:grid;grid-template-rows:48px 1fr}
  /* Toolbar */
  #toolbar{background:var(--toolbar);border-bottom:1px solid var(--panel-border);display:flex;align-items:center;gap:16px;padding:0 12px;user-select:none}
  #toolbar .menu{font-weight:700;opacity:.9;cursor:pointer}
  #toolbar .menu:hover{opacity:1}
  /* Layout: default landscape */
  #main{display:grid;grid-template-columns:1fr var(--panel-w);min-height:0}
  #viewport{position:relative;min-height:0}
  #panel{border-left:1px solid var(--panel-border);background:var(--panel);min-width:260px;overflow:auto}
  /* Portrait mobile: split top/bottom */
  @media (orientation:portrait){
    #main{grid-template-columns:1fr;grid-template-rows:55vh 45vh}
    #panel{border-left:none;border-top:1px solid var(--panel-border)}
  }
  canvas{display:block;width:100%;height:100%}
  /* Panel internals */
  .tabs{position:sticky;top:0;background:linear-gradient(to bottom, rgba(20,22,28,.98), rgba(20,22,28,.95));display:flex;gap:8px;padding:10px;border-bottom:1px solid var(--panel-border);z-index:5}
  .tab{flex:1;text-align:center;padding:8px;border-radius:10px;background:rgba(255,255,255,.04);border:1px solid transparent;color:var(--muted);font-weight:800}
  .tab.active{color:var(--text);background:rgba(77,163,255,.12);border-color:rgba(77,163,255,.25)}
  .pane{padding:10px;display:none}
  .pane.active{display:block}
  .group{border:1px solid var(--panel-border);border-radius:12px;background:rgba(255,255,255,.03);padding:10px;margin-bottom:10px}
  .group h3{margin:0 0 6px 0;font-size:12px;letter-spacing:.3px;opacity:.9}
  .row{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:center;margin:7px 0}
  .row label{color:var(--muted);font-size:12px}
  .row output{min-width:70px;text-align:right;font-variant-numeric:tabular-nums}
  input[type="range"], select, input[type="color"], input[type="file"], input[type="number"], input[type="text"]{
    width:100%;background:rgba(255,255,255,.06);border:1px solid var(--panel-border);border-radius:10px;color:var(--text);padding:8px 10px
  }
  input[type="range"]{padding:0}
  button{appearance:none;background:linear-gradient(180deg, rgba(77,163,255,.22), rgba(77,163,255,.12));border:1px solid rgba(77,163,255,.35);color:var(--text);border-radius:10px;padding:8px 10px;font-weight:800}
  .list{border:1px solid var(--panel-border);border-radius:10px;overflow:hidden}
  .item{padding:8px 10px;border-bottom:1px solid var(--panel-border);cursor:pointer}
  .item:last-child{border-bottom:0}
  .item.active{background:rgba(77,163,255,.12)}
  /* Loader overlay */
  #loader{position:fixed;inset:0;background:#0a0c10;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:999}
  #logo{width:120px;height:120px;margin-bottom:18px}
  #bar{width:min(520px,80vw);height:10px;border-radius:6px;border:1px solid rgba(255,255,255,.2);overflow:hidden}
  #bar > span{display:block;height:100%;width:0;background:linear-gradient(90deg,#4da3ff,#77c1ff)}
  #status{margin-top:8px;color:#cdd6e6;font:12px ui-monospace,monospace}
</style>
</head>
<body>
  <div id="loader" aria-busy="true">
    <svg id="logo" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg" aria-label="Iconic">
      <defs><linearGradient id="g" x1="0" y1="0" x2="1" y2="1"><stop stop-color="#4da3ff"/><stop offset="1" stop-color="#8fd1ff"/></linearGradient></defs>
      <circle cx="50" cy="50" r="46" stroke="url(#g)" stroke-width="4"/>
      <path d="M26 70 L50 22 L74 70" stroke="url(#g)" stroke-width="6" stroke-linecap="round"/>
    </svg>
    <div id="bar"><span></span></div>
    <div id="status">loading…</div>
  </div>

  <div class="app" id="app" hidden>
    <div id="toolbar"></div>
    <div id="main">
      <div id="viewport" role="application" aria-label="3D viewport"></div>
      <aside id="panel">
        <div class="tabs">
          <button class="tab active" data-tab="scene">SCENE</button>
          <button class="tab" data-tab="material">MATERIAL</button>
        </div>
        <div class="pane active" id="pane-scene"></div>
        <div class="pane" id="pane-material"></div>
      </aside>
    </div>
  </div>

  <!-- Entry point -->
  <script type="module" src="./src/main.js"></script>
</body>
</html>